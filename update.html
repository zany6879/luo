<!doctype html>
<html lang="zh">

	<head>
		<meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />
		<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
		<title>大龙喵博客</title>
		<meta name="description" content="" />
		<meta name="keywords" content="" />
		<link rel="shortcut icon" href="./statics/img/logo.png" type="image/x-icon">
		<link rel="stylesheet" type="text/css" href="statics/css/index.css" media="all" />
		
<style>
	#file {
		position: fixed;
		top: 10px;
		left: 10px;
		z-index: 100;
	}
	
	#canvas {
		position: fixed;
		left: 0;
		top: 0;
		width: 100%;
		height: 100%;
	}
	
	#audio {
		position: fixed;
		left: 10px;
		bottom: 10px;
		z-index:999;
		/* width: calc(100% - 20px); */
	}
</style>
	</head>

	<body class="home blog custom-background round-avatars">
		<div class="Yarn_Background" style="background-image: url( statics/images/47fb3c_.jpg);"></div>
		<form class="js-search search-form search-form--modal" method="get" action="search.html" role="search">
			<div class="search-form__inner">
				<div>
					<div id="search-container" class="ajax_search">
						<form method="get" id="searchform" action="">
							<div class="filter_container"><input type="text" value="" autocomplete="off" placeholder="Type then select or enter" name="s" id="search-input" />
								<ul id="search_filtered" class="search_filtered"></ul>
							</div>
							<input type="submit" name="submit" id="searchsubmit" class="searchsubmit" value="" />
						</form>
					</div>
				</div>
			</div>
		</form>
		<div class="navi" data-aos="fade-down">
			<div class="bt-nav">
				<div class="line line1"></div>
				<div class="line line2"></div>
				<div class="line line3"></div>
			</div>
			<div class="navbar animated fadeInRight">
				<div class="inner">
					<nav id="site-navigation" class="main-navigation">
						<div id="main-menu" class="main-menu-container">
							<div class="menu-menu-container">
								<ul id="primary-menu" class="menu">
									<li id="menu-item-17" class="menu-item menu-item-type-custom menu-item-object-custom current-menu-item current_page_item menu-item-home menu-item-17">
										<a href="index.html">首页</a>
									</li>
									<li id="menu-item-173" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-173">
										<a href="update.html">音乐解析盒</a>
									</li>
									<li id="menu-item-78" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-78">
										<a href="link.html">斗罗大陆</a>
									</li>
									<li id="menu-item-252" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-has-children menu-item-252">
										<a href="archives.html">归档</a>
										<ul class="sub-menu">
											<li id="menu-item-165" class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-165">
												<a href="">theme</a>
											</li>
											<li id="menu-item-163" class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-163">
												<a href="">Happen</a>
											</li>
											<li id="menu-item-924" class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-924">
												<a href="">WeWork</a>
											</li>
											<li id="menu-item-164" class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-164">
												<a href="">WordPress</a>
											</li>
										</ul>
									</li>
									<li id="menu-item-57" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-57">
										<a href="gustbook.html">留言</a>
									</li>
								</ul>
							</div>
						</div>
					</nav>
					<!-- #site-navigation -->
				</div>
			</div>
		</div>
		<div class="hebin" data-aos="fade-down">
			<!-- <i class=" js-toggle-search iconfont">&#xe60e;</i> -->
			<!-- <div>fhl;guipo</div> -->
		</div>
		<header id="masthead" class="overlay animated from-bottom" itemprop="brand">
			<div class="site-branding text-center">
				<!-- <a href="">
					<figure>
						<img class="custom-logo avatar" src="statics/images/omikron.png" />
					</figure>
				</a> -->
				<h3 class="blog-description"><p></p></h3>
			</div>
			<!-- .site-branding -->
			<div class="decor-part">
				<div id="particles-js"></div>
			</div>
			<div class="animation-header">
				<div class="decor-wrapper">
					<!-- <svg id="header-decor" class="decor bottom" xmlns="http://www.w3.org/2000/svg" version="1.1" viewBox="0 0 100 100" preserveAspectRatio="none">
						<path class="large left" d="M0 0 L50 50 L0 100" fill="rgba(255,255,255, .1)"></path>
						<path class="large right" d="M100 0 L50 50 L100 100" fill="rgba(255,255,255, .1)"></path>
						<path class="medium left" d="M0 100 L50 50 L0 33.3" fill="rgba(255,255,255, .3)"></path>
						<path class="medium right" d="M100 100 L50 50 L100 33.3" fill="rgba(255,255,255, .3)"></path>
						<path class="small left" d="M0 100 L50 50 L0 66.6" fill="rgba(255,255,255, .5)"></path>
						<path class="small right" d="M100 100 L50 50 L100 66.6" fill="rgba(255,255,255, .5)"></path>
						<path d="M0 99.9 L50 49.9 L100 99.9 L0 99.9" fill="rgba(255,255,255, 1)"></path>
						<path d="M48 52 L50 49 L52 52 L48 52" fill="rgba(255,255,255, 1)"></path>
					</svg> -->
				</div>
			</div>
		</header>
			<div id="content main">
				<input style="
				color:#fff" type="file" id="file" accept="audio/*"/ placeholder="选择MP3文件">
				<canvas id="canvas"></canvas>
				<audio id="audio" controls></audio>
			</div>
		

		<footer id="footer" class="overlay animated from-top">
			<div class="decor-wrapper">
				<!-- <svg id="footer-decor" class="decor top" xmlns="http://www.w3.org/2000/svg" version="1.1" viewBox="0 0 100 100" preserveAspectRatio="none">
					<path class="large left" d="M0 0 L50 50 L0 100" fill="rgba(255,255,255, .1)"></path>
					<path class="large right" d="M100 0 L50 50 L100 100" fill="rgba(255,255,255, .1)"></path>
					<path class="medium left" d="M0 0 L50 50 L0 66.6" fill="rgba(255,255,255, .3)"></path>
					<path class="medium right" d="M100 0 L50 50 L100 66.6" fill="rgba(255,255,255, .3)"></path>
					<path class="small left" d="M0 0 L50 50 L0 33.3" fill="rgba(255,255,255, .5)"></path>
					<path class="small right" d="M100 0 L50 50 L100 33.3" fill="rgba(255,255,255, .5)"></path>
					<path d="M0 0 L50 50 L100 0 L0 0" fill="rgba(255,255,255, 1)"></path>
					<path d="M48 48 L50 51 L52 48 L48 48" fill="rgba(255,255,255, 1)"></path>
				</svg> -->
			</div>
			<div class="socialize" data-aos="zoom-in">
				<li>
					<a title="weibo" class="socialicon" href=""><i class="iconfont" aria-hidden="true">&#xe601;</i></a>
				</li>
				<li class="wechat">
					<a class="socialicon"><i class="iconfont">&#xe609;</i></a>
					<div class="wechatimg"><img src="statics/img/weix.png"></div>
				</li>
				<li>
					<a title="QQ" class="socialicon" href="" target="_blank"><i class="iconfont" aria-hidden="true">&#xe616;</i></a>
				</li>
			</div>
			<div class="cr">
				Copyright&copy;2021. Design by
				<a href="">Allen.zhang</a>
			</div>
			<script type='text/javascript' src='statics/js/jquery.min.js'></script>
			<script type='text/javascript' src='statics/js/plugins.js'></script>
			<script type='text/javascript' src='statics/js/script.js'></script>
			<script type='text/javascript' src='statics/js/particles.js'></script>
			<script type='text/javascript' src='statics/js/aos.js'></script>
			<script type="text/javascript">

				window.onload = function () {
				 
				 var file = document.getElementById("file");
				 var audio = document.getElementById("audio");
				
				 file.onchange = function () {
					 //part1: 画布
					 var canvas = document.getElementById("canvas");
					 var context = canvas.getContext("2d");
				
					 canvas.width = window.innerWidth;
					 canvas.height = window.innerHeight;
					 var WIDTH = canvas.width;
					 var HEIGHT = canvas.height;
				
					 //part2: 音频
					 var files = this.files;//声音文件
					 audio.src = URL.createObjectURL(files[0]);
					 audio.load();
				
					 //part3: 分析器
					 var AudCtx = new AudioContext();//音频内容
					 var src = AudCtx.createMediaElementSource(audio);
					 var analyser = AudCtx.createAnalyser();
				
					 src.connect(analyser);
					 analyser.connect(AudCtx.destination);
					 analyser.fftSize = 128;//快速傅里叶变换, 必须为2的N次方
				
					 var bufferLength = analyser.frequencyBinCount;// = fftSize * 0.5
				
					 //part4: 变量
					 var barWidth = (WIDTH / bufferLength) - 1;//间隔1px
					 var barHeight;
				
					 var dataArray = new Uint8Array(bufferLength);//8位无符号定长数组
				   
				
					 //part5: 动态监听
					 function renderFrame() {
						 requestAnimationFrame(renderFrame);//方法renderFrame托管到定时器，无限循环调度，频率<16.6ms/次
				
						 context.fillStyle = "#000";//黑色背景
						 context.fillRect(0, 0, WIDTH, HEIGHT);//画布拓展全屏,动态调整
				
						 analyser.getByteFrequencyData(dataArray);//获取当前时刻的音频数据
						 console.log(dataArray)
				
						 //part6: 绘画声压条
						 var x = 0;
						 for (var i = 0; i < bufferLength; i++) {
							 var data = dataArray[i];//int,0~255
				
							 var percentV = data / 255;//纵向比例
							 var percentH = i / bufferLength;//横向比例
				
							 barHeight = HEIGHT * percentV;
				
							 //gbk,0~255
							 var r = 255 * percentV;//值越大越红
							 var g = 255 * percentH;//越靠右越绿
							 var b = 50;
				
							 context.fillStyle = "rgb(" + r + "," + g + "," + b + ")";
							 context.fillRect(x, HEIGHT - barHeight, barWidth, barHeight);
				
							 x += barWidth + 1;//间隔1px
						 }
					 }
				
					 renderFrame();
				
					 //part7: 播放声音
					 audio.play();
				 };
				};
				</script>

	</body>

</html>